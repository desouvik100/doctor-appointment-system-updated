/* ========================================
   ANTI-FLICKER SYSTEM
   Prevents visual flickering on page load
   ======================================== */

/* ========================================
   PREVENT INITIAL FLASH
   ======================================== */

/* Ensure smooth rendering from the start */
html {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* Prevent white flash on load */
html,
body,
#root {
  background: transparent !important;
}

/* ========================================
   LOADING STATE
   ======================================== */

/* Hide animated content during initial load */
html.loading .fade-in-up,
html.loading .premium-title,
html.loading .premium-subtitle,
html.loading .hero-stats,
html.loading .hero-actions,
html.loading .trust-indicators,
html.loading .dashboard-preview {
  opacity: 0 !important;
  visibility: hidden !important;
}

/* ========================================
   LOADED STATE
   ======================================== */

/* Show content once loaded */
html.loaded .fade-in-up,
html.loaded .premium-title,
html.loaded .premium-subtitle,
html.loaded .hero-stats,
html.loaded .hero-actions,
html.loaded .trust-indicators,
html.loaded .dashboard-preview {
  opacity: 1 !important;
  visibility: visible !important;
}

/* ========================================
   PREVENT LAYOUT SHIFT
   ======================================== */

/* Prevent horizontal scroll flicker */
body {
  overflow-x: hidden !important;
  max-width: 100vw !important;
}

/* Prevent content jump */
#root {
  min-height: 100vh;
  position: relative;
}

/* ========================================
   SMOOTH TRANSITIONS
   ======================================== */

/* Only enable transitions after load */
html:not(.loaded) * {
  transition: none !important;
  animation-play-state: paused !important;
}

html.loaded * {
  animation-play-state: running !important;
}

/* ========================================
   BACKGROUND STABILITY
   ======================================== */

/* Ensure background doesn't flicker */
.App,
.medical-bg,
.dark-theme,
section,
main,
.container,
.container-fluid {
  background: transparent !important;
}

/* ========================================
   THEME TRANSITION
   ======================================== */

/* Smooth theme changes without flicker */
html[data-theme="light"],
html[data-theme="dark"] {
  transition: background 0.3s ease !important;
}

/* But not on initial load */
html.loading[data-theme="light"],
html.loading[data-theme="dark"] {
  transition: none !important;
}

/* ========================================
   ANIMATION STABILITY
   ======================================== */

/* Ensure animations don't cause flicker */
.fade-in-up,
[class*="fade"],
[class*="slide"] {
  animation-fill-mode: both !important;
  backface-visibility: hidden !important;
  -webkit-backface-visibility: hidden !important;
}

/* ========================================
   TEXT RENDERING
   ======================================== */

/* Prevent text flicker */
h1, h2, h3, h4, h5, h6, p, span, div {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ========================================
   IMAGE STABILITY
   ======================================== */

/* Prevent image flicker */
img {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
}

/* ========================================
   NAVBAR STABILITY
   ======================================== */

/* Prevent navbar flicker on scroll */
.navbar,
.medical-nav {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
  will-change: transform;
}

/* ========================================
   MODAL STABILITY
   ======================================== */

/* Prevent modal flicker */
.modal,
.modal-backdrop {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* ========================================
   CARD STABILITY
   ======================================== */

/* Prevent card flicker on hover */
.card,
.medical-card {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
}

/* ========================================
   BUTTON STABILITY
   ======================================== */

/* Prevent button flicker on interaction */
.btn,
button {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
}

/* ========================================
   SCROLL STABILITY
   ======================================== */

/* Prevent scroll flicker */
* {
  -webkit-overflow-scrolling: touch;
}

/* ========================================
   GPU ACCELERATION
   ======================================== */

/* Force GPU acceleration for smooth rendering */
.hero-section,
.navbar,
.card,
.btn,
.modal {
  transform: translateZ(0);
  will-change: transform;
}

/* ========================================
   PREVENT FOUC (Flash of Unstyled Content)
   ======================================== */

/* Hide body until styles are loaded */
html.loading body {
  visibility: visible !important;
  opacity: 1 !important;
}

/* ========================================
   MOBILE ANTI-FLICKER
   ======================================== */

@media (max-width: 768px) {
  /* Prevent mobile-specific flicker */
  html {
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Prevent touch flicker */
  * {
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  }
  
  /* Prevent scroll bounce flicker on iOS */
  body {
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
  }
}

/* ========================================
   DARK MODE ANTI-FLICKER
   ======================================== */

/* Ensure dark mode doesn't flicker */
html[data-theme="dark"] {
  color-scheme: dark;
}

html[data-theme="light"] {
  color-scheme: light;
}

/* ========================================
   PRINT ANTI-FLICKER
   ======================================== */

@media print {
  /* Disable animations for printing */
  * {
    animation: none !important;
    transition: none !important;
  }
}

/* ========================================
   REDUCED MOTION
   ======================================== */

/* Respect user preferences */
@media (prefers-reduced-motion: reduce) {
  html.loading .fade-in-up {
    opacity: 1 !important;
    visibility: visible !important;
  }
  
  * {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}

/* ========================================
   PERFORMANCE OPTIMIZATIONS
   ======================================== */

/* Optimize rendering performance */
.hero-section,
.navbar,
.card,
.modal {
  contain: layout style paint;
}

/* Prevent unnecessary repaints */
.static-content {
  will-change: auto;
}

/* ========================================
   CRITICAL RENDERING PATH
   ======================================== */

/* Prioritize above-the-fold content */
.hero-section {
  content-visibility: auto;
}

/* Defer below-the-fold content */
.below-fold {
  content-visibility: auto;
  contain-intrinsic-size: 0 500px;
}
